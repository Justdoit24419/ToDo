# 타이머 → 달력 연동 테스트 가이드

## 시스템 동작 방식

### 1. 할일 추가
- 대시보드에서 할일 입력 (예: "독서")
- 자동으로 오늘 날짜에 등록됨
- 서버에 즉시 저장됨

### 2. 타이머 시작
- 주작업 또는 보조작업 선택
- 시간 설정 (예: 25분)
- 시작 버튼 클릭
- **이 시점에는 아직 데이터가 저장되지 않음 (정상 동작)**

### 3. 타이머 정지/리셋/완료
타이머를 정지하거나 완료하면:
- 경과 시간 계산
- **최소 1분 이상** 경과해야 저장됨
- 서버 API 호출:
  - `POST /api/focus-history/update` - 오늘 날짜에 집중 시간 추가
  - `POST /api/hourly-focus/update` - 시간대별 집중 시간 추가
- 할일 목록의 focusTime 업데이트

### 4. 달력에 표시
- 데이터 관리 페이지로 이동
- 10초마다 자동으로 서버에서 최신 데이터 가져옴
- 월별 달력에 표시:
  - 오늘 날짜에 집중 시간 표시 (예: "25m")
  - 해당 날짜의 할일 목록 표시

## 테스트 절차

### ✅ 정상 동작 테스트

1. **브라우저 새로고침** (Cmd+R / Ctrl+R)

2. **로그인** (admin / admin1234)

3. **할일 추가**
   ```
   입력: "독서"
   → 자동으로 오늘 날짜(2025-12-09)에 등록
   ```

4. **먼저 데이터 관리 페이지로 이동해서 확인**
   ```
   - 좌측 네비게이션에서 "데이터 관리" 클릭
   - 오늘 날짜(12월 9일)를 찾기
   - "독서" 할일이 오늘 날짜 칸에 표시되어야 함 ✓
   - 아직 집중 시간은 0분 또는 표시 안 됨
   ```

5. **대시보드로 돌아가기**
   ```
   - 좌측 네비게이션에서 "대시보드" 클릭
   ```

6. **타이머 설정 및 시작**
   ```
   - 주작업: "독서" 선택
   - 시간: 25분 설정
   - 시작 버튼 클릭
   ```

7. **데이터 관리 페이지로 다시 이동**
   ```
   - 좌측 네비게이션에서 "데이터 관리" 클릭
   - 타이머가 실행 중인 상태로 확인
   - 오늘 날짜에 실시간으로 경과 시간이 표시되어야 함 ✓
   - "독서" 할일도 함께 표시됨 ✓
   ```

8. **대시보드로 돌아가서 최소 1분 이상 대기**
   ```
   - 좌측 네비게이션에서 "대시보드" 클릭
   ⏱️ 타이머가 24:00 이하로 내려가도록 대기
   (예: 25:00 → 24:30 → 24:00)
   ```

9. **타이머 정지**
   ```
   - ⏸️ 정지 버튼 클릭
   - 또는 ⏹️ 리셋 버튼 클릭
   ```

10. **브라우저 콘솔 확인** (F12)
    ```
    에러가 없어야 함
    다음 로그가 보여야 함:
    - "집중 시간 업데이트 완료" (또는 유사한 메시지)
    ```

11. **데이터 관리 페이지로 다시 이동**
    ```
    - 좌측 네비게이션에서 "데이터 관리" 클릭
    - 오늘 날짜(12월 9일)를 찾기
    - 집중 시간이 저장되어 표시되어야 함 (예: "1m", "2m" 등)
    - 할일 목록에 "독서"가 표시되어야 함
    ```

12. **날짜 클릭**
    ```
    - 오늘 날짜 클릭
    - 모달 창이 열림
    - 집중 시간과 할일 상세정보 표시
    ```

## 문제 해결

### 문제 1: 달력에 0분으로 표시됨
**원인**: 타이머를 1분 미만으로 실행
**해결**: 최소 1분 이상 타이머 실행 후 정지

### 문제 2: 달력에 아무것도 표시 안 됨
**원인**: 서버 연결 문제 또는 로그인 안 됨
**해결**:
1. 백엔드 서버 실행 확인: `http://localhost:3001`
2. 로그인 상태 확인
3. 브라우저 콘솔에서 에러 확인 (F12)

### 문제 3: 할일이 달력에 안 보임
**원인**: 할일에 날짜가 설정되지 않음
**해결**:
- 할일을 다시 추가하면 자동으로 오늘 날짜 설정됨
- 또는 할일 항목의 달력 아이콘 클릭해서 수동으로 날짜 설정

### 문제 4: 10초 기다려도 업데이트 안 됨
**해결**:
1. 페이지 수동 새로고침 (F5)
2. 백엔드 로그 확인: 에러가 없어야 함

## 백엔드 로그 확인

터미널에서 백엔드 로그를 확인하세요:
```bash
cd focus-backend
npm start
```

정상 로그:
```
🚀 포모도로 집중 대시보드 백엔드 서버 실행 중
📡 포트: 3001
🔐 관리자 계정: admin / admin1234
```

에러가 있으면 안 됩니다!

## 데이터베이스 직접 확인

```bash
cd focus-backend
cat db.json | grep -A 5 "focusHistory"
```

오늘 날짜(2025-12-09)에 데이터가 있어야 합니다:
```json
"focusHistory": {
  "admin-001": {
    "2025-12-09": 25
  }
}
```

## 추가 정보

### 브라우저 캐시 문제
문제가 지속되면 브라우저 하드 리프레시:
- Mac: Cmd + Shift + R
- Windows/Linux: Ctrl + Shift + R

### 로그아웃 후 재로그인
데이터가 보이지 않으면:
1. 로그아웃
2. 브라우저 새로고침
3. 다시 로그인 (admin / admin1234)
